{"failedCount":1,"prefixedPath":"classpath:test\/generateToken_copy.feature","packageQualifiedName":"test.generateToken_copy","loopIndex":-1,"relativePath":"test\/generateToken_copy.feature","scenarioResults":[{"sectionIndex":0,"stepResults":[{"result":{"nanos":13307636,"millis":13.307636,"status":"passed"},"step":{"endLine":18,"background":true,"line":5,"prefix":"*","docString":"function() {\nvar payload = {\nmobileNumber: \"+918448848902\",\ndeviceId: \"EB57FCDE-097D-4483-8CCF-27649FFC8B2A\"\n};\nvar secret = \"your-secret-key\";\nvar jwt = Java.type('io.jsonwebtoken.Jwts');\nvar token = jwt.builder().setPayload(payload).signWith(io.jsonwebtoken.SignatureAlgorithm.HS256, secret.getBytes(\"UTF-8\")).compact();\nkarate.log('Generated token:', token);\nreturn token;\n}","index":0,"text":"def generateJwtToken ="},"stepLog":"16:23:36.597 karate.env system property was: null \n"},{"result":{"nanos":293507975,"errorMessage":"js failed:\n>>>>\n01: generateJwtToken()\n<<<<\norg.graalvm.polyglot.PolyglotException: TypeError: invokeMember (setPayload) on io.jsonwebtoken.impl.DefaultJwtBuilder@2b289ac9 failed due to: Cannot convert '[object Object]'(language: JavaScript, type: Object) to Java type 'java.lang.String': Invalid or lossy primitive coercion.\n- <js>.:anonymous(Unnamed:8)\n\nclasspath:test\/generateToken_copy.feature:23","millis":293.507975,"status":"failed"},"step":{"comments":["# Given def jwtToken = call generateJwtToken(payload, secretKey, expirationMillis)"],"line":23,"prefix":"*","index":0,"text":"def jwtToken = generateJwtToken()"},"stepLog":"16:23:36.998 classpath:test\/generateToken_copy.feature:23\n* def jwtToken = generateJwtToken()\njs failed:\n>>>>\n01: generateJwtToken()\n<<<<\norg.graalvm.polyglot.PolyglotException: TypeError: invokeMember (setPayload) on io.jsonwebtoken.impl.DefaultJwtBuilder@2b289ac9 failed due to: Cannot convert '[object Object]'(language: JavaScript, type: Object) to Java type 'java.lang.String': Invalid or lossy primitive coercion.\n- <js>.:anonymous(Unnamed:8)\n\nclasspath:test\/generateToken_copy.feature:23\n"},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":25,"prefix":"And","index":1,"text":"header Authorization = jwtToken"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":27,"prefix":"Given","index":2,"text":"url 'https:\/\/apitest.livquik.com\/api\/v1\/bnpl\/processPayment'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":28,"prefix":"And","index":3,"text":"header TENANT = 'KOTAK_BNPL'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":29,"prefix":"And","index":4,"text":"header Content-Type = 'application\/json'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":30,"prefix":"And","index":5,"text":"header public-key = 'Bearer cGtfbGl2ZV94NjIzRkpNZmFJbmk6c2tfbGl2ZV9xeUVwSUJaQWQxcG1aNk9oMklUOG43UjlmSzFVbmM2aEQ3VGtHSUxy'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":31,"prefix":"And","index":6,"text":"header User-Agent = 'PostmanRuntime\/7.31.1'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":32,"prefix":"When","index":7,"text":"method POST"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":33,"prefix":"Then","index":8,"text":"status 200"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":34,"prefix":"And","index":9,"text":"match $.result.status == 'failed'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":35,"prefix":"And","index":10,"text":"match $.result.statusCode == 'PAY_1002'"}},{"result":{"nanos":0,"millis":0.0,"status":"skipped"},"step":{"line":36,"prefix":"And","index":11,"text":"match $.result.message == 'Invalid credentials.'"}}],"line":21,"description":"","durationMillis":306.815611,"failed":true,"error":"js failed:\n>>>>\n01: generateJwtToken()\n<<<<\norg.graalvm.polyglot.PolyglotException: TypeError: invokeMember (setPayload) on io.jsonwebtoken.impl.DefaultJwtBuilder@2b289ac9 failed due to: Cannot convert '[object Object]'(language: JavaScript, type: Object) to Java type 'java.lang.String': Invalid or lossy primitive coercion.\n- <js>.:anonymous(Unnamed:8)\n\nclasspath:test\/generateToken_copy.feature:23","executorName":"main","name":"Generate JWT token and use it in header","startTime":1682679216239,"refId":"[1:21]","endTime":1682679216998,"exampleIndex":-1}],"callDepth":0,"name":"process payment api testing to check error message validation","description":"","resultDate":"2023-04-28 04:23:37 pm","durationMillis":306.815611,"passedCount":0}